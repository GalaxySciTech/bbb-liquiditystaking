# XDC æµåŠ¨æ€§è´¨æŠ¼ç³»ç»Ÿ

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äº Lido çš„æµåŠ¨æ€§è´¨æŠ¼ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è´¨æŠ¼ XDC å¹¶è·å¾—æµåŠ¨æ€§å‡­è¯ä»£å¸ bXDCã€‚bXDC ä¸ XDC çš„å…‘æ¢æ¯”ä¾‹ä¼šéšç€è´¨æŠ¼å¥–åŠ±çš„å¢åŠ è€ŒåŠ¨æ€å˜åŒ–ï¼Œä½¿æŒæœ‰è€…èƒ½å¤Ÿäº«å—è´¨æŠ¼æ”¶ç›Šã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·åŠŸèƒ½

#### è´¨æŠ¼ XDC
- ç”¨æˆ·å‘é€ XDC åˆ°åˆçº¦ï¼ŒæŒ‰å½“å‰å…‘æ¢æ¯”ä¾‹è·å¾— bXDC
- æœ€å°è´¨æŠ¼æ•°é‡ï¼š1 XDCï¼ˆå¯è°ƒæ•´ï¼‰
- bXDC å¯è‡ªç”±è½¬è´¦å’Œäº¤æ˜“

#### è¯·æ±‚èµå›
- ç”¨æˆ·å¯ä»¥ç”¨ bXDC å…‘æ¢å› XDC
- éœ€è¦ç®¡ç†å‘˜å®¡æ ¸æ‰¹å‡†
- æœ€å°èµå›æ•°é‡ï¼š0.1 XDCï¼ˆå¯è°ƒæ•´ï¼‰

### 2. ç®¡ç†å‘˜åŠŸèƒ½

#### å®¡æ ¸èµå›è¯·æ±‚
- æ‰¹å‡†æˆ–æ‹’ç»ç”¨æˆ·çš„èµå›è¯·æ±‚
- æ”¯æŒæ‰¹é‡æ‰¹å‡†æ“ä½œ
- æ‹’ç»çš„è¯·æ±‚ä¼šè¿”è¿˜ bXDC ç»™ç”¨æˆ·

#### æå– XDC è¿è¡Œ Validator
- æå–åˆçº¦ä¸­çš„ XDC ç”¨äºè¿è¡ŒéªŒè¯èŠ‚ç‚¹
- æœ€å¤šå¯æå–æ€»æ± åŒ– XDC çš„ 80%ï¼ˆå¯è°ƒæ•´ï¼‰
- ç¡®ä¿åˆçº¦æµåŠ¨æ€§

#### å­˜å…¥è´¨æŠ¼å¥–åŠ±
- å°† validator è·å¾—çš„è´¨æŠ¼å¥–åŠ±å­˜å›åˆçº¦
- è‡ªåŠ¨æ›´æ–° bXDC/XDC å…‘æ¢æ¯”ä¾‹
- æ‰€æœ‰ bXDC æŒæœ‰è€…è‡ªåŠ¨äº«å—æ”¶ç›Š

## å…‘æ¢æ¯”ä¾‹æœºåˆ¶

### åˆå§‹çŠ¶æ€
- 1 bXDC = 1 XDC (1:1)

### æ”¶ç›Šå¢é•¿
å½“ç®¡ç†å‘˜å­˜å…¥è´¨æŠ¼å¥–åŠ±åï¼Œå…‘æ¢æ¯”ä¾‹ä¼šæå‡ã€‚ä¾‹å¦‚ï¼š
- åˆå§‹ï¼š100 XDC è´¨æŠ¼ï¼Œé“¸é€  100 bXDC
- è·å¾—å¥–åŠ±ï¼š10 XDC
- æ–°æ¯”ä¾‹ï¼š1 bXDC = 1.1 XDC
- æŒæœ‰è€…ä»·å€¼å¢é•¿ 10%

### è®¡ç®—å…¬å¼
```
å…‘æ¢æ¯”ä¾‹ = æ€»æ± åŒ– XDC / bXDC æ€»ä¾›åº”é‡

bXDC æ•°é‡ = XDC æ•°é‡ Ã— bXDC æ€»ä¾›åº”é‡ / æ€»æ± åŒ– XDC

XDC æ•°é‡ = bXDC æ•°é‡ Ã— æ€»æ± åŒ– XDC / bXDC æ€»ä¾›åº”é‡
```

## åˆçº¦æ¶æ„

### bXDC åˆçº¦
- ERC20 ä»£å¸
- åç§°ï¼šStaked XDC
- ç¬¦å·ï¼šbXDC
- åªèƒ½ç”±è´¨æŠ¼æ± åˆçº¦é“¸é€ å’Œé”€æ¯

### XDCLiquidityStaking åˆçº¦
- ä¸»è¦è´¨æŠ¼é€»è¾‘
- ç®¡ç†è´¨æŠ¼å’Œèµå›
- æ§åˆ¶å…‘æ¢æ¯”ä¾‹
- å¤„ç† validator èµ„é‡‘

## éƒ¨ç½²æ­¥éª¤

1. éƒ¨ç½²åˆçº¦ï¼š
```bash
npx hardhat run scripts/liquidityStakingDeploy.js --network xdc
```

2. ä¿å­˜åˆçº¦åœ°å€ï¼ˆä¼šè‡ªåŠ¨ä¿å­˜åˆ° deployments ç›®å½•ï¼‰

3. éªŒè¯åˆçº¦ï¼ˆå¯é€‰ï¼‰ï¼š
```bash
npx hardhat verify --network xdc <STAKING_POOL_ADDRESS>
```

## ä½¿ç”¨ç¤ºä¾‹

### ç”¨æˆ·è´¨æŠ¼

```javascript
// 1. è´¨æŠ¼ 100 XDC
const stakeAmount = ethers.parseEther("100");
await stakingPool.stake({ value: stakeAmount });

// 2. æŸ¥è¯¢ bXDC ä½™é¢
const balance = await bxdc.balanceOf(userAddress);
console.log(`bXDC ä½™é¢: ${ethers.formatEther(balance)}`);
```

### ç”¨æˆ·èµå›

```javascript
// 1. æˆæƒ
const bxdcAmount = ethers.parseEther("10");
await bxdc.approve(stakingPoolAddress, bxdcAmount);

// 2. è¯·æ±‚èµå›
await stakingPool.requestWithdrawal(bxdcAmount);

// 3. æŸ¥è¯¢èµå›è¯·æ±‚
const requestIds = await stakingPool.getUserWithdrawalRequests(userAddress);
```

### ç®¡ç†å‘˜æ“ä½œ

```javascript
// 1. æ‰¹å‡†èµå›è¯·æ±‚
await stakingPool.approveWithdrawal(requestId);

// 2. æ‰¹é‡æ‰¹å‡†
await stakingPool.batchApproveWithdrawals([id1, id2, id3]);

// 3. æå– XDC è¿è¡Œ validator
const amount = ethers.parseEther("1000");
await stakingPool.withdrawForValidator(amount);

// 4. å½’è¿˜æœ¬é‡‘å’Œå­˜å…¥å¥–åŠ±
// æ­¥éª¤1ï¼šç›´æ¥è½¬è´¦å½’è¿˜æœ¬é‡‘ï¼ˆä¸è°ƒç”¨ä»»ä½•å‡½æ•°ï¼‰
await signer.sendTransaction({
    to: stakingPoolAddress,
    value: ethers.parseEther("1000") // å½’è¿˜æœ¬é‡‘
});

// æ­¥éª¤2ï¼šè°ƒç”¨ depositRewards å­˜å…¥å¥–åŠ±ï¼ˆä»…å¥–åŠ±éƒ¨åˆ†ï¼‰
const rewards = ethers.parseEther("50");
await stakingPool.depositRewards({ value: rewards });
```

### æŸ¥è¯¢ä¿¡æ¯

```javascript
// 1. æŸ¥è¯¢å½“å‰å…‘æ¢æ¯”ä¾‹
const rate = await stakingPool.getExchangeRate();
console.log(`1 bXDC = ${ethers.formatEther(rate)} XDC`);

// 2. è®¡ç®—å¯è·å¾—çš„ bXDC
const bxdcAmount = await stakingPool.getbXDCByXDC(xdcAmount);

// 3. è®¡ç®—å¯èµå›çš„ XDC
const xdcAmount = await stakingPool.getXDCBybXDC(bxdcAmount);

// 4. æŸ¥è¯¢å¾…å¤„ç†çš„èµå›è¯·æ±‚
const pendingIds = await stakingPool.getPendingWithdrawalIds();

// 5. æŸ¥è¯¢æ€»æ± åŒ– XDC
const totalPooled = await stakingPool.totalPooledXDC();
```

## å®Œæ•´å·¥ä½œæµç¨‹

### 1. åˆå§‹é˜¶æ®µ
```
ç”¨æˆ·A è´¨æŠ¼ 100 XDC â†’ è·å¾— 100 bXDC
ç”¨æˆ·B è´¨æŠ¼ 50 XDC  â†’ è·å¾— 50 bXDC
----------------------------------------
æ€»æ± åŒ–: 150 XDC
bXDC ä¾›åº”: 150
å…‘æ¢æ¯”ä¾‹: 1:1
```

### 2. è¿è¡Œ Validator
```
ç®¡ç†å‘˜æå– 120 XDC è¿è¡Œ validator èŠ‚ç‚¹
åˆçº¦ä½™é¢: 30 XDCï¼ˆä¿æŒæµåŠ¨æ€§ï¼‰
æ€»æ± åŒ–: 150 XDCï¼ˆä¸å˜ï¼‰
```

### 3. è·å¾—å¥–åŠ±
```
Validator è·å¾— 15 XDC å¥–åŠ±
ç®¡ç†å‘˜æ“ä½œï¼š
  1. ç›´æ¥å‘åˆçº¦è½¬è´¦ 120 XDCï¼ˆå½’è¿˜æœ¬é‡‘ï¼Œä¸æ”¹å˜totalPooledXDCï¼‰
  2. è°ƒç”¨ depositRewards å­˜å…¥ 15 XDCï¼ˆä»…å¥–åŠ±éƒ¨åˆ†ï¼‰
----------------------------------------
æ€»æ± åŒ–: 165 XDC (150 + 15)
bXDC ä¾›åº”: 150ï¼ˆä¸å˜ï¼‰
æ–°å…‘æ¢æ¯”ä¾‹: 1 bXDC = 1.1 XDC
ğŸ“ˆ æ‰€æœ‰æŒæœ‰è€…æ”¶ç›Š +10%
```

### 4. ç”¨æˆ·èµå›
```
ç”¨æˆ·A èµå› 50 bXDC
- æŒ‰ 1.1 æ¯”ä¾‹å¯è·å¾— 55 XDC
- æäº¤èµå›è¯·æ±‚
- ç®¡ç†å‘˜å®¡æ ¸æ‰¹å‡†
- ç”¨æˆ·A æ”¶åˆ° 55 XDC
----------------------------------------
æ€»æ± åŒ–: 110 XDC
bXDC ä¾›åº”: 100
å…‘æ¢æ¯”ä¾‹: ä»ä¸º 1:1.1ï¼ˆæ¯”ä¾‹ä¿æŒï¼‰
```

## å®‰å…¨ç‰¹æ€§

1. **ReentrancyGuard**: é˜²æ­¢é‡å…¥æ”»å‡»
2. **Pausable**: ç´§æ€¥æƒ…å†µå¯æš‚åœåˆçº¦
3. **Ownable**: å…³é”®æ“ä½œä»…ç®¡ç†å‘˜å¯æ‰§è¡Œ
4. **å®¡æ ¸æœºåˆ¶**: èµå›éœ€è¦ç®¡ç†å‘˜æ‰¹å‡†
5. **æµåŠ¨æ€§ä¿æŠ¤**: é™åˆ¶æœ€å¤§å¯æå–æ¯”ä¾‹

## å‚æ•°é…ç½®

ç®¡ç†å‘˜å¯è°ƒæ•´çš„å‚æ•°ï¼š

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|-------|------|
| minStakeAmount | 1 XDC | æœ€å°è´¨æŠ¼æ•°é‡ |
| minWithdrawAmount | 0.1 XDC | æœ€å°èµå›æ•°é‡ |
| maxWithdrawablePercentage | 80% | æœ€å¤§å¯æå–æ¯”ä¾‹ |

è°ƒæ•´æ–¹æ³•ï¼š
```javascript
await stakingPool.setMinStakeAmount(ethers.parseEther("5"));
await stakingPool.setMinWithdrawAmount(ethers.parseEther("1"));
await stakingPool.setMaxWithdrawablePercentage(70);
```

## äº‹ä»¶æ—¥å¿—

åˆçº¦ä¼šå‘å‡ºä»¥ä¸‹äº‹ä»¶ç”¨äºç›‘æ§ï¼š

- `Staked`: ç”¨æˆ·è´¨æŠ¼
- `WithdrawalRequested`: èµå›è¯·æ±‚
- `WithdrawalApproved`: èµå›æ‰¹å‡†
- `WithdrawalRejected`: èµå›æ‹’ç»
- `ValidatorFundsWithdrawn`: æå–èµ„é‡‘
- `RewardsDeposited`: å­˜å…¥å¥–åŠ±

## è¿è¡Œæ¼”ç¤ºè„šæœ¬

```bash
# è®¾ç½®åˆçº¦åœ°å€
export STAKING_POOL_ADDRESS=0x...

# è¿è¡Œæ¼”ç¤º
npx hardhat run scripts/liquidityStakingDemo.js --network xdc
```

## æ³¨æ„äº‹é¡¹

1. **èµå›å®¡æ ¸**: ç”¨æˆ·èµå›éœ€è¦ç®¡ç†å‘˜å®¡æ ¸ï¼Œä¸æ˜¯å³æ—¶çš„
2. **æµåŠ¨æ€§ç®¡ç†**: ç®¡ç†å‘˜åº”ç¡®ä¿åˆçº¦æœ‰è¶³å¤Ÿä½™é¢å¤„ç†èµå›
3. **å¥–åŠ±é¢‘ç‡**: å»ºè®®å®šæœŸå­˜å…¥å¥–åŠ±ä»¥æ›´æ–°å…‘æ¢æ¯”ä¾‹
4. **Gas è´¹ç”¨**: æ‰¹é‡æ“ä½œå¯ä»¥èŠ‚çœ gas è´¹ç”¨
5. **ä»·æ ¼æ»‘ç‚¹**: å¤§é¢èµå›å¯èƒ½å½±å“åˆçº¦æµåŠ¨æ€§

## å‰ç«¯é›†æˆ

æ¨èåœ¨å‰ç«¯å±•ç¤ºï¼š
1. å½“å‰ APYï¼ˆå¹´åŒ–æ”¶ç›Šç‡ï¼‰
2. å®æ—¶å…‘æ¢æ¯”ä¾‹
3. ç”¨æˆ· bXDC ä½™é¢åŠå¯¹åº”çš„ XDC ä»·å€¼
4. èµå›è¯·æ±‚çŠ¶æ€
5. åˆçº¦æ€»é”ä»“é‡ï¼ˆTVLï¼‰

## è®¸å¯è¯

MIT License
